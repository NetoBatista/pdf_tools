using System.Net;
using Microsoft.Extensions.Logging;
using Moq;
using PdfTools.Constant;
using PdfTools.Dto;
using PdfTools.Service;

namespace PdfToolsTest.Service;

[TestClass]
public class PdfToTextServiceTest
{
    private const string ExampleUrl = "https://pdfobject.com/pdf/sample.pdf";
    private const string ExamplePdf = "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Zy9QYWdlcyA2IDAgUgovT3BlbkFjdGlvblsxIDAgUiAvWFlaIG51bGwgbnVsbCAwXQovTGFuZyhwdC1CUikKPj4KZW5kb2JqCgoxNSAwIG9iago8PC9DcmVhdG9yPEZFRkYwMDU3MDA3MjAwNjkwMDc0MDA2NTAwNzI+Ci9Qcm9kdWNlcjxGRUZGMDA0QzAwNjkwMDYyMDA3MjAwNjUwMDRGMDA2NjAwNjYwMDY5MDA2MzAwNjUwMDIwMDAzNDAwMkUwMDMxPgovQ3JlYXRpb25EYXRlKEQ6MjAxNDA1MTYxMzI0MzQtMDMnMDAnKT4+CmVuZG9iagoKeHJlZgowIDE2CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwNzgzNSAwMDAwMCBuIAowMDAwMDAwMDE5IDAwMDAwIG4gCjAwMDAwMDAyNDQgMDAwMDAgbiAKMDAwMDAwMDI2NCAwMDAwMCBuIAowMDAwMDAwNDQxIDAwMDAwIG4gCjAwMDAwMDc5NzggMDAwMDAgbiAKMDAwMDAwMDQ4MSAwMDAwMCBuIAowMDAwMDA2OTAzIDAwMDAwIG4gCjAwMDAwMDY5MjQgMDAwMDAgbiAKMDAwMDAwNzExNCAwMDAwMCBuIAowMDAwMDA3NDY3IDAwMDAwIG4gCjAwMDAwMDc2NzcgMDAwMDAgbiAKMDAwMDAwNzcxMCAwMDAwMCBuIAowMDAwMDA4MDc3IDAwMDAwIG4gCjAwMDAwMDgxNzQgMDAwMDAgbiAKdHJhaWxlcgo8PC9TaXplIDE2L1Jvb3QgMTQgMCBSCi9JbmZvIDE1IDAgUgovSUQgWyA8RDFGQTcwNDMyNzVCNzUxNTUyQjZBNTE1Q0VBOTI2MEU+CjxEMUZBNzA0MzI3NUI3NTE1NTJCNkE1MTVDRUE5MjYwRT4gXQovRG9jQ2hlY2tzdW0gLzJEMEVGN0MyOTIxRkY1Q0YxOEUxRUZFRkRDMzFCNDI2Cj4+CnN0YXJ0eHJlZgo4MzQ5CiUlRU9GCg==";
    private const string ExampleImage = "iVBORw0KGgoAAAANSUhEUgAAAGEAAABNCAYAAAC2aAruAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADMSURBVHhe7dGhAcAgEMDA0v13fjwDQMSdjM2amfl46j8D95kQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEmBJgQYEKACQEb6a8Eln5Bmy8AAAAASUVORK5CYII=";
    private PdfToTextRequestDto CreateRequest()
    {
        return new PdfToTextRequestDto
        {
            Type = TypePdfToTextConstant.Base64,
            File = ExamplePdf
        };
    }

    private PdfToTextService CreateService()
    {
        var loggerMock = new Mock<ILogger<PdfToTextService>>();
        return new PdfToTextService(loggerMock.Object);
    }

    [TestMethod("Should be convert pdf base 64  to text")]
    public void ConvertPdfBase64ToTextSuccess()
    {
        var request = CreateRequest();
        var service = CreateService();

        var response = service.Execute(request);
        Assert.AreEqual(response.StatusCode, HttpStatusCode.OK);
    }

    [TestMethod("Should be convert pdf url to text")]
    public void ConvertPdfUrlToTextSuccess()
    {
        var request = new PdfToTextRequestDto
        {
            Type = TypePdfToTextConstant.Url,
            File = ExampleUrl
        };
        var service = CreateService();

        var response = service.Execute(request);
        Assert.AreEqual(response.StatusCode, HttpStatusCode.OK);
    }

    [TestMethod("Should not be convert pdf to text - Error empty content")]
    public void ConvertPdfToTextErrorEmptyContent()
    {
        var request = CreateRequest();
        request.File = string.Empty;
        var service = CreateService();

        var response = service.Execute(request);
        Assert.AreEqual(response.StatusCode, HttpStatusCode.BadRequest);
    }

    [TestMethod("Should not be convert pdf to text")]
    public void ConvertPdfToTextError()
    {
        var request = CreateRequest();
        request.File = ExampleImage;
        var service = CreateService();

        var response = service.Execute(request);
        Assert.AreEqual(response.StatusCode, HttpStatusCode.BadRequest);
    }
}